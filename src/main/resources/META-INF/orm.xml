<?xml version="1.0" encoding="UTF-8"?>
<entity-mappings xmlns="http://java.sun.com/xml/ns/persistence/orm"
                 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                 xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm http://java.sun.com/xml/ns/persistence/orm_2_0.xsd"
                 version="2.0">
    <named-query name="Application.findByMemberId">
        <query>SELECT appl FROM Application appl WHERE appl.member.id=?1 and appl.status in(0,1,2,3,4)</query>
    </named-query>
    <named-query name="RepayPlan.findByMemberId">
        <query>SELECT rp FROM RepayPlan rp WHERE rp.dueDate &lt;= CURRENT_DATE and rp.paidPrincipal =0 and
            rp.member.id=?2 order by rp.dueDate, rp.dueAmt
        </query>
    </named-query>

    <named-native-query name="Pboc.findByStatusWithSummary" result-set-mapping="pbocSummary">
        <query>SELECT pb.id as id, pb.certNo as certNo, pb.name as name, pb.create_Time as createTime,
            pb.keyiner as keyiner, pb.risk as risk, pb.status as status FROM Pboc pb where pb.status in (2,3)
        </query>
    </named-native-query>

    <named-native-query name="Pboc.searchWithSummary" result-set-mapping="pbocSummary">
        <query>SELECT pb.id as id, pb.certNo as certNo, pb.name as name, pb.create_Time as createTime,pb.keyiner as keyiner, pb.risk as risk, pb.status as status FROM Pboc pb where :q
        </query>
    </named-native-query>


    <named-native-query name="TvQuestionList.Random" result-set-mapping="tvQuestionListMapping">
        <query>  select home.ADDRESS from (select top 2 ADDRESS from TV_QUESTION_LIST where FLAG = 2 and CITY = ?1 order by newid()) home
                 union select company.ADDRESS from (select top 2 ADDRESS from TV_QUESTION_LIST where FLAG = 1 and CITY = ?1 order by newid()) company</query>
    </named-native-query>

    <named-native-query name="Application.findApplicationSummaries" result-set-mapping="applicationSummary">
        <query>
select appl.APPL_NO as appNo, idcard.NAME, idcard.ID_NO as idCardNo, appl.EXISTING_FLAG as existingFlag, appl.APPLY_TIME as applyDate,
                ma.CITY as mobileCity, appl.STATUS as status, appl.CREATE_TIME as createDate,apv.CREDITOR  as creditor from APPL appl , APPROVAL apv, MEMBER member, ID_CARD idcard, VALUE_MOBILE_AREA ma where appl.MEMBER_ID = member.ID and appl.APPL_NO = apv.APPL_NO and member.ID = idcard.MEMBER_ID
                and ma.N1_7 = substring(member.MOBILE, 0 , 8)
        </query>
    </named-native-query>

    <sql-result-set-mapping name="pbocSummary">
        <column-result name="id"/>
        <column-result name="certNo"/>
        <column-result name="name"/>
        <column-result name="createTime"/>
        <column-result name="keyiner"/>
        <column-result name="risk"/>
        <column-result name="status"/>
    </sql-result-set-mapping>
    <sql-result-set-mapping name="tvQuestionListMapping">
        <column-result name="address"/>
    </sql-result-set-mapping>

    <sql-result-set-mapping name="applicationSummary">
        <column-result name="appNo"/>
        <column-result name="name"/>
        <column-result name="idCardNo"/>
        <column-result name="existingFlag"/>
        <column-result name="applyDate"/>
        <column-result name="mobileCity"/>
        <column-result name="status"/>
        <column-result name="createDate"/>
        <column-result name="creditor"/>
    </sql-result-set-mapping>
</entity-mappings>