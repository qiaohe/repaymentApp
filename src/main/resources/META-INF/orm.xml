<?xml version="1.0" encoding="UTF-8"?>
<entity-mappings xmlns="http://java.sun.com/xml/ns/persistence/orm"
                 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                 xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm http://java.sun.com/xml/ns/persistence/orm_2_0.xsd"
                 version="2.0">
    <named-query name="Application.findApplicationSummaries">
        <query>
            select NEW com.huayuan.domain.credit.ApplicationSummary(appl.applicationNo, idcard.name, idcard.idNo,
            appl.existingFlag, appl.applyTime,
            ma.city, appl.status, appl.createTime,apv.creditor) from Application appl , Approval apv,
            IdCard idcard, Member mem, ValueMobileArea ma where appl.member.id = mem.id and
            appl.applicationNo = apv.application.applicationNo and mem.id = idcard.member.id
            and ma.sevenPrefix = substring(mem.mobile, 0 , 8) and (appl.status = '3' or appl.status = '99')
        </query>
    </named-query>
    <named-query name="Application.findByMemberId">
        <query>SELECT appl FROM Application appl WHERE appl.member.id=?1 and appl.status in(0,1,2,3,4)</query>
    </named-query>
    <named-query name="IdCard.findFromPbocOut">
        <query>SELECT ic from IdCard ic where ic.idNo in (select id_No from PbocOut)</query>
    </named-query>

    <named-query name="RepayPlan.findByMemberId">
        <query>SELECT rp FROM RepayPlan rp WHERE rp.dueDate &lt;= CURRENT_DATE and rp.paidPrincipal =0 and
            rp.member.id=?2 order by rp.dueDate, rp.dueAmt
        </query>
    </named-query>
    <named-query name="RepayPlan.findByLoanId">
        <query>SELECT rp FROM RepayPlan rp WHERE rp.loan.id =?1 order by rp.dueDate asc
        </query>
    </named-query>
    <named-query name="TelephoneVerification.findByTypeAndDecision">
        <query>select tv from TelephoneVerification tv where tv.type = ?1 and tv.decision = ?2 and (tv.tvMemAns1 != ''
            or tv.tvMemAns2 != '')
        </query>
    </named-query>

    <named-query name="Pboc.findByStatusWithSummary">
        <query>SELECT NEW com.huayuan.domain.credit.PbocSummary(pb.id, pb.certNo, pb.name, pb.createTime,
            pb.keyiner, pb.risk, pb.status) FROM Pboc pb where pb.status in (2,3)
        </query>
    </named-query>

    <named-native-query name="TvQuestionList.Random" result-set-mapping="tvQuestionListMapping">
        <query>  select home.ADDRESS from (select top 2 ADDRESS from TV_QUESTION_LIST where FLAG = 2 and CITY = ?1 order by newid()) home
                 union select company.ADDRESS from (select top 2 ADDRESS from TV_QUESTION_LIST where FLAG = 1 and CITY = ?1 order by newid()) company</query>
    </named-native-query>

    <sql-result-set-mapping name="tvQuestionListMapping">
        <column-result name="address"/>
    </sql-result-set-mapping>
</entity-mappings>